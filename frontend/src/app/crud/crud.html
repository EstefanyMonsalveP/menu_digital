<div class="container my-4">
  <div class="row gx-3 gy-4">
    <!-- Tarjeta + para añadir nuevo plato -->
    <div class="col-sm-6 col-md-4 col-lg-3">
      <div class="card h-100 text-center p-3" style="cursor:pointer;" (click)="editingDish.set(null); formNewDish.set({image:'', dishName:'', description:'', price:0})">
        <!-- Mostrar el formulario si se presiona -->
        @if(formNewDish()){
          <h6>Nuevo Plato</h6>
          <form (ngSubmit)="saveDish(formNewDish()!)" class="row g-2">
            <div class="col-12">
              <input type="text" class="form-control form-control-sm" placeholder="URL Imagen" [(ngModel)]="formNewDish()!.image" name="image" />
            </div>
            <div class="col-12">
              <input type="text" class="form-control form-control-sm" placeholder="Nombre" [(ngModel)]="formNewDish()!.dishName" name="dishName" />
            </div>
            <div class="col-12">
              <input type="text" class="form-control form-control-sm" placeholder="Descripción" [(ngModel)]="formNewDish()!.description" name="description" />
            </div>
            <div class="col-12">
              <input type="number" class="form-control form-control-sm" placeholder="Precio" [(ngModel)]="formNewDish()!.price" name="price" />
            </div>
            <div class="col-12">
              <button type="submit" class="btn btn-success btn-sm w-100 mt-2">Guardar</button>
            </div>
          </form>
        }
        @if(!formNewDish()){
          <div>
            <span class="display-4">+</span>
            <p>Agregar nuevo plato</p>
          </div>
        }
      </div>
    </div>

    <!-- Tarjetas de platos existentes -->
     @for(dish of dishes(); track dish._id){
        <div class="col-sm-6 col-md-4 col-lg-3">
        <div class="card h-100 mb-3 p-3">
      
      <!-- Si esta tarjeta es la que se está editando -->
      @if(editingDish() && editingDish()!._id === dish._id){
        <form (ngSubmit)="editDish()" class="row g-2">
          <div class="col-12">
            <input type="text" class="form-control form-control-sm" placeholder="URL Imagen" [(ngModel)]="formEditingDish()!.image" name="image" />
          </div>
          <div class="col-12">
            <input type="text" class="form-control form-control-sm" placeholder="Nombre" [(ngModel)]="formEditingDish()!.dishName" name="dishName" />
          </div>
          <div class="col-12">
            <input type="text" class="form-control form-control-sm" placeholder="Descripción" [(ngModel)]="formEditingDish()!.description" name="description" />
          </div>
          <div class="col-12">
            <input type="number" class="form-control form-control-sm" placeholder="Precio" [(ngModel)]="formEditingDish()!.price" name="price" />
          </div>
          <div class="col-12">
            <button type="submit" class="btn btn-success btn-sm w-100 mt-2">Guardar</button>
          </div>
        </form>
      }
      
      <!-- Mostrar la info normal si no se está editando -->
      @if(!editingDish() || editingDish()!._id !== dish._id){
        <img [src]="dish.image" class="card-img-top" alt="{{ dish.dishName }}" style="height:150px; object-fit:cover;">
        <div class="card-body p-2">
          <h6 class="card-title">{{ dish.dishName }}</h6>
          <p class="card-text">{{ dish.description }}</p>
          <p class="fw-bold mb-2">${{ dish.price }}</p>
          <button type="button" class="btn btn-primary btn-sm me-1" (click)="selectDish(dish)">Editar</button>
          <button type="button" class="btn btn-danger btn-sm" (click)="deleteDish(dish._id!)">Eliminar</button>
        </div>
      }
    </div>
  </div>
}
  </div>
</div>
